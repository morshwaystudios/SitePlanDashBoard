<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Red Zone Floorplan</title>
<style>
  :root {
    --bg:#0b0f14; 
    --panel:#10161d; 
    --text:#e8f0f7;
    --muted:#9fb0c3; 
    --accent:#e74d3c;
  }
  html, body {
    margin:0; 
    height:100%; 
    background:var(--bg); 
    color:var(--text);
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
  }
  header {
    display:flex; 
    align-items:center; 
    justify-content:space-between;
    padding:12px 20px; 
    background:#1b2430; 
    border-bottom:1px solid #2b3a4a;
  }
  header h1 { 
    margin:0; 
    font-size:20px; 
    font-weight:600; 
    color:var(--text);
  }
  header button {
    background:#2b3a4a; 
    border:1px solid #445567; 
    color:#e8f0f7;
    padding:6px 14px; 
    border-radius:8px; 
    cursor:pointer;
    transition:all 0.2s ease;
  }
  header button:hover {
    background:#e74d3c; 
    border-color:#e74d3c;
  }
  .map {
    flex:1; 
    display:flex; 
    align-items:center; 
    justify-content:center; 
    padding:20px;
  }
  .map img { 
    width:100%; 
    height:auto; 
    max-height:80vh;
    object-fit:contain; 
    border-radius:12px; 
    box-shadow:0 4px 16px rgba(0,0,0,0.6);
  }
  .sheet-section {
    background:var(--panel); 
    border-top:1px solid #2b3a4a; 
    padding:20px;
  }
  .sheet-header {
    display:flex; 
    justify-content:space-between; 
    align-items:center; 
    margin-bottom:10px;
  }
  .sheet-header span { 
    color:var(--muted); 
    font-size:14px;
  }
  .sheet-header button {
    background:#2b3a4a; 
    border:1px solid #445567; 
    color:#e8f0f7;
    padding:6px 12px; 
    border-radius:8px; 
    cursor:pointer;
    transition:all 0.2s ease;
  }
  .sheet-header button:hover {
    background:#e74d3c; 
    border-color:#e74d3c;
  }
  iframe {
    width:100%; 
    height:500px;
    border:1px solid #2b3a4a; 
    border-radius:12px; 
    background:#0c1218;
  }
</style>
</head>
<body>
  <header>
    <h1>Red Zone Floorplan</h1>
    
  </header>
  
  <div class="map">
    <img src="RedZone.png" alt="Red Zone Floorplan">
  </div>

  <div class="sheet-section">
    <div class="sheet-header">
      <span>Auto-refreshes every 5 minutes (v1.0)</span>
      <button onclick="refreshSheet()">‚ü≥ Reload Sheet</button>
    </div>
    <iframe 
      id="sheetFrame"
      src=""
      allowfullscreen>
    </iframe>
  </div>

<script>
const sheetBase = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRtQF5drtvDEFskm7wQJVxNw43QKCYDGxTwGJSOnmdAFA1zow7taXMs5EMLf4YxprNMvwXDxLjY3Q4V/pubhtml?gid=0&single=true&widget=true&headers=false";

function refreshSheet() {
  document.getElementById("sheetFrame").src = sheetBase + "&t=" + new Date().getTime();
}

// initial load
refreshSheet();

// auto refresh every 45s
setInterval(refreshSheet, 45000);
</script>
</body>
</html>
